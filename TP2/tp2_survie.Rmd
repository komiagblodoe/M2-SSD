---
title: "TP2 Biostatistique"
author: "AGBLODOE Komi/  M2 SSD"
date: "18 décembre 2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ISwR)
```

```{r}


d<-melanom


dim(d)

attach(melanom)


```

1. Pour quelles valeurs de la variable status les données sont-elles censurées? Expliquer

les données sont censurées pour les valeurs 2 et 3 de la variable censurées. Car ces deux variables ne sont pas liées à la mélanonme. (par définition de la variable status on a: 1 : mort liée mélanome, 2 : vivant à la ???n de l'étude, 3 : mort d'un autre cause)


2 Créer un object de type survie sous R à partir de cette base

```{r}

library(survival)
attach(melanom)

base=Surv(days,status == 1)

```

3 Estimer la courbe de survie par la m´ethode de Kaplan-Meier, `a l'aide de la fonction survfit

```{r}
fit1<-survfit(base~1)
plot(fit1,conf.int=TRUE)

```

4 Estimer les courbes de survie pour chaque sexe (1 : F, 2 : H) 

```{r}

fit2<-survfit(base~sex)
plot(fit2,mark.time=TRUE, conf.int = TRUE,col=c("blue","red"))
legend("bottomleft", c("Femmes","Hommes"),col=c("blue","red"),lty=1)

```


5 On souhaite maintenant tester si le sexe a une in???uence sur la survie. Quel test proposez vous? Le mettre en place a` l'aide de la fonction survdiff de R. Quel autre test peut-on r´ealiser? Utiliser pour cela l'option rho de la fonction survdiff

```{r}
base<-Surv(days,status==1)

survdiff(base~sex,data=d) #(test du log-rank)
survdiff(base~sex,data=d,rho=1) #(test de log-rank généralisé)

```

6 Construire un modèle de Cox expliquant la durée de survie par la variable sexe. On pourra utiliser la fonction coxph de R. 

```{r}

coxph(base ~ sex) 

```


7. Construire un modèle de Cox expliquant la durée de survie en fonction de la variable thick. 
```{r}

coxph(base ~ thick) 
```

Vous proposerez di???érents codages de la variable thick

Pour ce faire on coupe la variable thick en différentes classes(ici 5).

```{r}

library(Hmisc)

table(cut2(thick,g=5))
```



8. Construire un modèle de Cox multivarié. 


```{r}

coxph(base ~sex+thick)
coxph(base ~sex+thick+ulc)
coxph(base ~thick+ulc)
coxph(base ~sex+ulc)

```

Valider le modèle et interpréter les résultats

```{r}
#Voir la fonction R  cox.zph(model)

```

